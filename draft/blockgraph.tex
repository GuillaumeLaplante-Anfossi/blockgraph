\documentclass{amsart}

\usepackage[T1]{fontenc}
\usepackage{%enumerate, 
amsmath, amsfonts, amssymb, amsthm, mathrsfs, wasysym, graphics, graphicx, xcolor, url, hyperref, hypcap, xargs, multicol, pdflscape, multirow, hvfloat, array, ae, aecompl, pifont, mathtools, a4wide, float, blkarray, overpic, nicefrac}
\usepackage[shortlabels, inline]{enumitem}%shortlabels to have same syntax as enumerate package, inline gives inline option with *
\usepackage{bbm}%allows for \mathbbm{1}
\usepackage[noabbrev,capitalise]{cleveref}
\usepackage[normalem]{ulem}
\usepackage{marginnote}
\hypersetup{colorlinks=true, citecolor=darkblue, linkcolor=darkblue}
\usepackage[all]{xy}
\usepackage{tikz}
\usepackage{tikz-cd}
%\usepackage{tkz-graph}
\usetikzlibrary{trees, decorations, decorations.pathmorphing, decorations.markings, decorations.shapes, shapes, arrows, matrix, calc, fit, intersections, patterns, angles}
\graphicspath{{figures/}{figures/diagonals/}{figures/walks/}{figures/tubes/}{figures/blocks/}}
\makeatletter\def\input@path{{figures/}}\makeatother
\usepackage{caption}
\captionsetup{width=\textwidth}
\usepackage[export]{adjustbox}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% theorems
\newtheorem{theorem}{Theorem}[section]
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{conjecture}[theorem]{Conjecture}
\newtheorem*{theorem*}{Theorem}%[section]

\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{example}[theorem]{Example}
\newtheorem{remark}[theorem]{Remark}
\newtheorem{question}[theorem]{Question}
\newtheorem{notation}[theorem]{Notation}
\newtheorem{assumption}[theorem]{Assumption}
\newtheorem{convention}[theorem]{Convention}

\crefname{equation}{Equation}{Equations}

% math special letters
\newcommand{\R}{\mathbb{R}} % reals
\newcommand{\Q}{\mathbb{Q}} % rationals
\newcommand{\N}{\mathbb{N}} % naturals
\newcommand{\Z}{\mathbb{Z}} % integers
\newcommand{\C}{\mathbb{C}} % complex
\newcommand{\I}{\mathbb{I}} % set of integers
\newcommand{\HH}{\mathbb{H}} % hyperplane
\newcommand{\K}{k} % field
\newcommand{\bb}[1]{{\mathbb{#1}}} % mathbb letters
\newcommand{\f}[1]{{\mathfrak{#1}}} % mathfrak letters
\renewcommand{\c}[1]{{\mathcal{#1}}} % call letters
\renewcommand{\b}[1]{{\boldsymbol{#1}}} % bold letters
\newcommand{\h}{\widehat} % hat letters

% math commands
\newcommand{\set}[2]{\left\{ #1 \;\middle|\; #2 \right\}} % set notation
\newcommand{\bigset}[2]{\big\{ #1 \;\big|\; #2 \big\}} % big set notation
\newcommand{\Bigset}[2]{\Big\{ #1 \;\Big|\; #2 \Big\}} % Big set notation
\newcommand{\setangle}[2]{\left\langle #1 \;\middle|\; #2 \right\rangle} % set notation
\newcommand{\ssm}{\smallsetminus} % small set minus
\newcommand{\dotprod}[2]{\langle \, #1 \; | \; #2 \, \rangle} % dot product
\newcommand{\bigdotprod}[2]{\big\langle \, #1 \; \big| \; #2 \, \big\rangle} % dot product
\newcommand{\symdif}{\,\triangle\,} % symmetric difference
\newcommand{\one}{\mathbbm{1}} % the all one vector
\newcommandx{\ones}[1][1=n]{\one_{#1}} % the all one vector of length n
\newcommand{\eqdef}{\mbox{\,\raisebox{0.2ex}{\scriptsize\ensuremath{\mathrm:}}\ensuremath{=}\,}} % :=
\newcommand{\defeq}{\mbox{~\ensuremath{=}\raisebox{0.2ex}{\scriptsize\ensuremath{\mathrm:}} }} % =:
\newcommand{\simplex}{\triangle} % simplex
\renewcommand{\implies}{\Rightarrow} % imply sign
\newcommand{\transpose}[1]{{#1}^T} % transpose matrix
\newcommand{\truth}[1]{\left[ #1 \right]} % truth (kronecker delta)

% operators
\DeclareMathOperator{\conv}{conv} % convex hull
\DeclareMathOperator{\vect}{vect} % linear span
\DeclareMathOperator{\cone}{cone} % cone hull

% others
\newcommand{\ie}{\textit{i.e.}~} % id est
\newcommand{\eg}{\textit{e.g.}~} % exempli gratia
\newcommand{\Eg}{\textit{E.g.}~} % exempli gratia
\newcommand{\apriori}{\textit{a priori}} % a priori
\newcommand{\viceversa}{\textit{vice versa}} % vice versa
\newcommand{\versus}{\textit{vs.}~} % versus
\newcommand{\aka}{\textit{a.k.a.}~} % also known as
\newcommand{\perse}{\textit{per se}} % per se
\newcommand{\ordinal}{\textsuperscript{th}} % th for ordinals
\newcommand{\ordinalst}{\textsuperscript{st}} % st for ordinals
\definecolor{darkblue}{rgb}{0,0,0.7} % darkblue color
\definecolor{green}{RGB}{57,181,74} % green color
\definecolor{violet}{RGB}{147,39,143} % violet color
\newcommand{\red}{\color{red}} % red command
\newcommand{\blue}{\color{blue}} % blue command
\newcommand{\orange}{\color{orange}} % orange command
\newcommand{\green}{\color{green}} % green command
\newcommand{\darkblue}{\color{darkblue}} % darkblue command
\newcommand{\defn}[1]{\textsl{\darkblue #1}} % emphasis of a definition
\newcommand{\para}[1]{\medskip\noindent\uline{\textit{#1.}}} % paragraph
\renewcommand{\topfraction}{1} % possibility to have one page of pictures
\renewcommand{\bottomfraction}{1} % possibility to have one page of pictures
\newcommand{\ex}{_{\textrm{exm}}} % examples
\newcommand{\pa}{_{\textrm{pa}}} % path
\newcommand*\circled[1]{\tikz[baseline=(char.base)]{\node[shape=circle, draw, inner sep=1.5pt, scale=.7] (char) {#1};}}
\newcommand{\compactVectorD}[2]{\begin{bmatrix} #1 \\ #2 \end{bmatrix}}
\newcommand{\compactVectorT}[3]{\begin{bmatrix} #1 \\[-.1cm] #2 \\[-.1cm] #3 \end{bmatrix}}

% marginal comments
\usepackage{todonotes}
\newcommand{\guillaume}[1]{\todo[color=orange!30]{#1 --- G.}}
\newcommand{\vincent}[1]{\todo[color=blue!30]{#1 \\ \hfill --- V.}}

% polytopes
\newcommand{\polytope}[1]{\mathsf{#1}} % font polytopes
\newcommandx{\Perm}[1][1=n]{\polytope{Perm}_{#1}} % permutahedron

% geometry
\newcommandx{\Asso}[2][1=n,2={}]{\mathsf{Asso}^{#2}(#1)} % associahedron
\newcommandx{\Nest}[2][1=\building,2={}]{\mathsf{Nest}^{#2}(#1)} % associahedron
% \newcommandx{\Zono}[2][1=n,2={}]{\mathsf{Zono}^{#2}(#1)} % zonotope
\newcommand{\walls}{\b{W}} % walls

\newcommandx{\Fan}[1][1=F]{\mathcal{#1}} % fan
\newcommand{\multiplicityVector}{\b{m}} % multiplicity vector
\newcommand{\gvector}[1]{\b{g}(#1)} % g-vector of #1
\newcommand{\gvectorFull}[2]{\b{g}(#1,#2)} % g-vector of #2 wrt #1
\newcommand{\gvectors}[1]{\b{g}(#1)} % g-vectors of #1
\newcommand{\gvectorsFull}[2]{\b{g}(#1,#2)} % g-vectors of #2 wrt #1
\newcommandx{\nestedFan}[1][1=\quiver]{\mathcal{F}(#1)} % g-vector fan
\newcommand{\cvector}[2]{\mathbf{c}(#2 \in #1)} % c-vector of the cluster variable #2 in the cluster #1
\newcommand{\cvectorFull}[3]{\mathbf{c}(#1,#3 \in #2)} % c-vector of the cluster variable #3 in the cluster #2 with respect to the initial cluster #1
\newcommand{\cvectors}[1]{\mathbf{c}(#1)} % c-vectors of the cluster #1
\newcommand{\cvectorsFull}[2]{\mathbf{c}(#1,#2)} % c-vectors of the cluster #2 with respect to the initial cluster #1
\newcommand{\ivector}[1]{\b{\iota}_{#1}} % i-vector of #1
\newcommandx{\ray}[1][1=r]{\b{#1}} % ray
\newcommandx{\rays}[1][1=R]{\b{#1}} % rays

% graphical zonotopes
\newcommandx{\gZono}[1][1=G]{\mathsf{Z}_{#1}} % graphical zonotope
\newcommandx{\gArr}[1][1=G]{\mathcal{A}_{#1}} % graphical arrangement
\newcommandx{\gFan}[1][1=G]{\Fan_{#1}} % graphical fan projected
\newcommandx{\gFanO}[1][1=G]{\widehat{\Fan}_{#1}} % graphical fan unprojected
\newcommandx{\cc}[1][1=G]{\mathbb{K}_{#1}} % connected components space
\newcommandx{\braid}[1][1=n]{\mathcal{B}_{#1}} %braid fan/arrangement
\newcommandx{\sbraid}[1][1=n]{\widehat{\mathcal{B}}_{#1}} %split braid fan
\newcommandx{\dZono}[1][1=\b{h}]{\mathsf{D}_{#1}} % h-deformed zonotope



%Decorations
\newcommandx{\up}[1][1=v]{\overline{#1}} 
\newcommandx{\down}[1][1=v]{\underline{#1}} 
\newcommandx{\updown}[1][1=v]{\overline{\underline{#1}}} 

%Source and target
\newcommandx{\so}[1][1=i]{\textsc{s}(#1)} 
\newcommandx{\ta}[1][1=o]{\textsc{t}(#1)} 

%Set of spines
\newcommandx{\spine}[1][1=S]{#1} 
\newcommandx{\spines}[1][1=G]{\mathcal{S}(#1)} 
\newcommandx{\maxspines}[1][1=G]{\mathcal{MS}(#1)} 

% Type cone
\newcommand{\deformationCone}{\mathbb{DC}} % deformation cone
\newcommand{\typeCone}{\mathbb{TC}} % type cone
\newcommand{\ctypeCone}{\smash{\overline{\mathbb{TC}}}} % type cone
\newcommandx{\coefficient}[3][1={\b{s}}, 2=\b{r}, 3=\b{r}']{\alpha_{#2,#3}(#1)} % coefficient in linear dependence
\newcommandx{\virtualPolytopes}[1][1=d]{\mathbb{V}^{#1}} % virtual polytopes
\newcommandx{\VDP}[1][1=n]{\mathbb{VDP}^{#1}} % virtual deformed permutahedra
\newcommandx{\CVDP}[1][1=n]{\overrightarrow{\mathbb{VDP}}^{#1}} % caged virtual deformed permutahedra
\newcommand{\VD}[1][1=n]{\mathbb{VD}} % virtual deformations
\newcommand{\Weight}{\mathbb{W}} % 1st weight space
\newcommandx{\opcone}[1][1={\mu,\omega}]{\polytope{C}_{#1}}
\newcommandx{\orcone}[1][1={\omega}]{\polytope{C}_{#1}}

% formating the part command
\makeatletter
\def\part{\@startsection{part}{1}%
\z@{.7\linespacing\@plus\linespacing}{.8\linespacing}%
{\LARGE\sffamily\centering}}
%\@addtoreset{section}{part}
\makeatother
\renewcommand{\thepart}{\Roman{part}}
%\renewcommand{\thesection}{\arabic{part}.\arabic{section}}

% formating the table of contents
\setcounter{tocdepth}{4}
\makeatletter
\def\l@section{\@tocline{1}{5pt}{0pc}{}{}}
\makeatother
\let\oldtocpart=\tocpart
\renewcommand{\tocpart}[2]{\sc\large\oldtocpart{#1}{#2}}
\let\oldtocsection=\tocsection
\renewcommand{\tocsection}[2]{\bf\oldtocsection{#1}{#2}}
\let\oldtocsubsubsection=\tocsubsubsection
\renewcommand{\tocsubsubsection}[2]{\quad\oldtocsubsubsection{#1}{#2}}

%Drapeau europÃ©en

\usepackage{graphicx,calc}
\newlength\myheight
\newlength\mydepth
\settototalheight\myheight{Xygp}
\settodepth\mydepth{Xygp}
\setlength\fboxsep{0pt}
\newcommand*\inlinegraphics[1]{%
  \settototalheight\myheight{Xygp}%
  \settodepth\mydepth{Xygp}%
  \raisebox{-\mydepth}{\includegraphics[height=\myheight]{#1}}%
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\title{Block graph permutreehedra}

\author{Guillaume Laplante-Anfossi}
\address[Guillaume Laplante-Anfossi]{Universit\'e Sorbonne Paris Nord, Laboratoire Analyse, G\'eom\'etrie et Applications, CNRS, UMR 7539, F-93430 Villetaneuse, France}
\email{laplante-anfossi@math.univ-paris13.fr}
\urladdr{\url{https://www.math.univ-paris13.fr/~laplante-anfossi/}}

\author{Vincent Pilaud}
\address[Vincent Pilaud]{CNRS \& LIX, \'Ecole Polytechnique, Palaiseau}
\email{vincent.pilaud@lix.polytechnique.fr}
\urladdr{\url{http://www.lix.polytechnique.fr/~pilaud/}}

\date{\today}

\subjclass[2010]{Primary 52B11; Secondary 18M70} 

\keywords{Polytopes...}

\thanks{The first author was supported by the European Union's Horizon 2020 research and innovation program under the Marie Sklodowska-Curie grant agreement No 754362 \inlinegraphics{EU.png}, by the Natural Sciences and Engineering Research Council of Canada (NSERC) and by the ANR-20-CE40-0016 Higher Algebra, Geometry and Topology. The second author...supported by the French ANR grants CAPPS~17\,CE40\,0018, and CHARMS~19\,CE40\,0017.}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{document}

\begin{abstract}
TBC
\end{abstract}

\maketitle

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section*{Introduction}

Common generalization of \cite{PilaudSignedTree13,LangePilaud13,PonsPilaud18,LA21}.
It is the maximal generalization, according to \cite{Pilaud14}.

\subsection*{Conventions} We write $[n] \eqdef \{1,\ldots,n\}$.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Combinatorics: the spine complex}

Exemples a suivre tout au long du texte: 1) chemin decore 2) que des down 3) un exemple "generique" de notre cru.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Maple trees and block graphs}

\begin{definition}
  A \defn{maple tree} is a tree properly colored in red and blue such that all leaves are red.
  The \defn{tapping} of a maple tree consists in replacing each red vertex by a clique on its blue neighbors.
\end{definition}

\begin{definition}
  \label{def:blockgraph}
  A \defn{block graph} is a connected graph~$G$ satisfying any of the following equivalent conditions:
  \begin{enumerate}
    \item Every biconnected component of~$G$ is a clique.
    \item Any cycle in~$G$ induces a clique.
    \item The intersection of two paths in~$G$ induces a path.
    \item The set of connected subgraphs of~$G$ is stable under intersection.
    \item The graph~$G$ is obtained by tapping a maple tree.
  \end{enumerate}
\end{definition}

Note that a block graph is obtained by tapping different maple trees. For instance, one can arbitrarily add red leaves to the blue vertices.

For convenience, in a maple tree, we label the blue vertices by digits (or numbers) and the red vertices by letters (or words).
Consequently, in a block graph, we label the vertices by digits (or numbers) and the cliques by letters (or words).
In this paper, we consider the following additional decorations.

\begin{definition}
  A \defn{decorated} maple tree (resp.~block graph) is a maple tree where each blue vertex~$v$ (resp.~each vertex~$v$) is decorated as~$v, \up, \down$ or~$\updown$.
  For a subset~$V$ of vertices, we denote by~$\up[V]$ the set of vertices~$\up$ and~$\updown$ of~$V$, and by~$\down[V]$ the set of vertices~$\down$ and~$\updown$ of~$V$
\end{definition}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Spine poset}

\begin{definition}
  In a directed tree~$\spine$, 
  \begin{itemize}
    \item the \defn{source set} (resp.~\defn{target set}) of a directed arc~$\gamma$ is the set~$\so[\gamma]$ (resp.~$\ta[\gamma]$) of nodes of the connected component of $\spine \ssm \{\gamma\}$ containing the source of $\gamma$ (resp.~the target of~$\gamma$),
    \item the \defn{source set} (resp.~\defn{target set}) of a node~$U$ is the union~$\so[U]$ (resp.~$\ta[U]$) of~$U$ with the source sets~$\so[\alpha]$ of all incoming arcs~$\alpha$ (resp.~the target sets~$\ta[\beta]$ of all outgoing arcs~$\beta$) of~$U$ in~$\spine$.
  \end{itemize}
\end{definition}

\begin{definition}
  \label{def:spine}
  A \defn{spine} on a decorated block graph $G$ is a directed tree $\spine$ such that
  \begin{enumerate}
    \item its nodes of~$\spine$ form a partition of the vertices of~$G$, and 
    \item at each node~$U$ of~$\spine$, the source sets $\so[\alpha]$ of the incoming arcs $\alpha$ are contained in distinct connected components of $G \ssm \down[U]$, and the target sets $\ta[\beta]$ of the outgoing arcs $\beta$ are contained in distinct connected components of $G \ssm \up[U]$.
  \end{enumerate}
  We denote by $\spines$ the set of spines on~$G$.
\end{definition}

We now define two natural operations on spines: arc contraction and node splitting.

\begin{definition}
  \label{def:arccontraction}
  Let $G$ be a decorated block graph, let $\spine$ be a spine on $G$, and let~$\gamma$ be an arc of~$\spine$ with endpoints~$U$ and~$V$.
  The \defn{contraction} of~$\gamma$ in~$\spine$ is the directed tree obtained from~$\spine$ by replacing the nodes~$U$ and~$V$ by a single node~$W \eqdef U \cup V$ and attaching to~$W$ all arcs incident to either~$U$~or~$V$.
  See \cref{fig:contractionSplitting}.
\end{definition}

\begin{figure}[h!]
\centering

\begin{tikzpicture}[scale=1.6]
    
\node (N0) [circle,draw=none,minimum size=4mm,inner sep=0.1mm] at (-0.5,-0.5) {\small $U$};
\node (N1) [circle,draw=none,minimum size=4mm,inner sep=0.1mm] at (0.5,0.5) {\small $V$};

\node (o1) [circle,draw=none,minimum size=4mm,inner sep=0.1mm] at (-1.2,0.6) {\small $\beta_1$};
\node (od) [circle,draw=none,minimum size=4mm,inner sep=0.1mm] at (-0.8,0.6) {\small $\dots$};
\node (oj) [circle,draw=none,minimum size=4mm,inner sep=0.1mm] at (-0.3,0.6) {\small $\beta_k$};

\node (oj1) [circle,draw=none,minimum size=4mm,inner sep=0.1mm] at (0,1.62) {\small $\beta_{k+1}$};
\node (ojd) [circle,draw=none,minimum size=4mm,inner sep=0.1mm] at (0.5,1.6) {\small $\dots$};
\node (ol) [circle,draw=none,minimum size=4mm,inner sep=0.1mm] at (1,1.6) {\small $\beta_\ell$};

\node (i1) [circle,draw=none,minimum size=4mm,inner sep=0.1mm] at (-1,-1.6) {\small $\alpha_1$};
\node (id) [circle,draw=none,minimum size=4mm,inner sep=0.1mm] at (-0.5,-1.6) {\small $\dots$};
\node (im) [circle,draw=none,minimum size=4mm,inner sep=0.1mm] at (0,-1.6) {\small $\alpha_i$};

\node (im1) [circle,draw=none,minimum size=4mm,inner sep=0.1mm] at (0.3,-0.62) {\small $\alpha_{i+1}$};
\node (imd) [circle,draw=none,minimum size=4mm,inner sep=0.1mm] at (0.8,-0.6) {\small $\dots$};
\node (ik) [circle,draw=none,minimum size=4mm,inner sep=0.1mm] at (1.2,-0.6) {\small $\alpha_j$};

\draw[->] (N0)--(o1); 
\draw[->] (N0)--(od);
\draw[->] (N0)--(oj);
  
\draw[->] (N0)--(N1) node[midway,left] {$\gamma$} ; 
\draw[->] (N1)--(oj1); 
\draw[->] (N1)--(ojd);
\draw[->] (N1)--(ol);

\draw[->] (i1)--(N0);
\draw[->] (id)--(N0);
\draw[->] (im)--(N0); 

\draw[->] (im1)--(N1); 
\draw[->] (imd)--(N1);
\draw[->] (ik)--(N1);


\end{tikzpicture}
\quad \quad \resizebox{0.04\linewidth}{!}{\raisebox{5em}{$\longrightarrow$}}\quad \quad
\begin{tikzpicture}[scale=1.2]
    

  \node (N1) [circle,draw=none,minimum size=4mm,inner sep=0.1mm] at (0,0) {\small $U \cup V$};
  
  
  \node (oj1) [circle,draw=none,minimum size=4mm,inner sep=0.1mm] at (-0.6,1.5) {\small $\beta_1$};
  \node (ojd) [circle,draw=none,minimum size=4mm,inner sep=0.1mm] at (0,1.5) {\small $\dots$};
  \node (ol) [circle,draw=none,minimum size=4mm,inner sep=0.1mm] at (0.6,1.5) {\small $\beta_\ell$};
  
  
  \node (im1) [circle,draw=none,minimum size=4mm,inner sep=0.1mm] at (-0.6,-1.5) {\small $\alpha_1$};
  \node (imd) [circle,draw=none,minimum size=4mm,inner sep=0.1mm] at (0,-1.5) {\small $\dots$};
  \node (ik) [circle,draw=none,minimum size=4mm,inner sep=0.1mm] at (0.6,-1.5) {\small $\alpha_j$};
  
  
  \draw[->] (N1)--(oj1); 
  \draw[->] (N1)--(ojd);
  \draw[->] (N1)--(ol);
  
  \draw[->] (im1)--(N1); 
  \draw[->] (imd)--(N1);
  \draw[->] (ik)--(N1);
  

\end{tikzpicture}
\caption{Contraction and splitting on spines.}
\label{fig:contractionSplitting}
\end{figure} 

\begin{proposition}
  \label{prop:arccontraction}
  The contraction of any arc in any spine on~$G$ is a spine on~$G$.
\end{proposition}

\begin{proof} 
  Let $\spine'$ be a directed tree obtained by contracting an arc in a spine $\spine$ on~$G$.
  We clearly just need to prove the local condition of \cref{def:spine} around the node~$W \eqdef U \cup V$ of~$\spine'$.
  We give the argument for the incoming arcs; the argument for the outgoing arcs is symmetric. 

  To prove that the source set of each incoming arc~$\alpha$ of~$W$ is contained in a connected component of~$G \ssm \down[W]$, we distinguish two cases:
  \begin{itemize}
    \item If~$\alpha$ is an incoming arc of~$U$ in~$\spine$, then its source set $\so[\alpha]$ is contained in a connected component $C_1$ of $G \ssm \down[U]$ and also in a connected component $C_2$ of $G \ssm \down[V]$. Thus, it is in $C_1 \cap C_2$. By \cref{def:blockgraph}, the subgraph induced by the vertices of $C_1 \cap C_2$ is a connected component of $(G \ssm \down[U]) \cap (G \ssm \down[V]) = G \ssm \down[W]$.
    \item If~$\alpha$ is an incoming arc of~$V$ in~$\spine$, then its source set $\so[\alpha]$ is in a connected component of $G \ssm \down[V]$ that does not contain $U$, hence in a connected component of $G \ssm \down[W]$.
  \end{itemize}

  To prove that the source sets of two distinct incoming arcs~$\alpha$ and~$\alpha'$ of~$W$ are contained in two distinct connected components of~$G \ssm \down[W]$, we distinguish two cases:
  \begin{itemize}
    \item If~$\alpha$ and~$\alpha'$ are both incoming arcs of~$U$ (resp.~of~$V$) in~$\spine$, then $\so[\alpha]$ and $\so[\alpha']$ live in two distinct connected components of $G \ssm \down[U]$ (resp.~of~$G \ssm \down[V]$), hence in two distinct connected components of $G\ssm \down[W]$.
    \item If~$\alpha$ is an incoming arc of~$U$ in~$\spine$ while~$\alpha'$ is an incoming arc of~$V$ in~$\spine$, then~$\so[\alpha] \subset \so[\gamma]$ and $\so[\alpha']$ live in two distinct connected components of $G \ssm \down[V]$, hence in two distinct connected components of $G\ssm \down[W]$.
    \qedhere
  \end{itemize}
\end{proof}

To define the reverse operation of node splitting, we first need the following notion.

\begin{definition}
  \label{def:splittable}
  Let~$G$ be a decorated block graph, and let~$W$ be a subset of vertices of~$G$.
  A partition~$U \sqcup V = W$ is \defn{splittable} if~$U \ne \varnothing$ is contained in a connected component of~$G \ssm \down[V]$ and $V \ne \varnothing$ is contained in a connected component of~$G \ssm \up[U]$.
\end{definition}

\begin{proposition}
  \label{prop:splittablePartitions}
  Let $G$ be a decorated block graph. Any subset $W$ of vertices of~$G$ with $|W| \ge 2$ admits a splittable partition.
\end{proposition}

\begin{proof} 
  Consider a spanning tree~$T$ of~$G$, and an edge~$e$ of~$T$ such that both connected components~$X$ and~$Y$ of~$T \ssm \{e\}$ intersect~$W$.
  Let~$U \eqdef W \cap X$ and~$V \eqdef W \cap Y$.
  Then~$U \ne \varnothing$ is contained in a connected component of~$T \ssm Y$, thus in a connected component of~$G \ssm \down[V]$ (since~$T \subseteq G$ and~$\down[V] \subseteq Y$).
  Similarly $V \ne \varnothing$ is contained in a connected component of~$T \ssm X$, thus in a connected component of~$G \ssm \up[U]$.
\end{proof}

\begin{definition}
  \label{def:vertexsplitting} 
  Let $G$ be a decorated block graph, let $\spine$ be a spine on $G$, let~$W$ be a node of~$\spine$, and let~$U \sqcup V = W$ be a splittable partition of~$W$.
  The \defn{splitting} of~$U \sqcup V$ in~$\spine$ is the directed tree obtained from~$\spine$ by:
  \begin{enumerate}[(i)]
    \item replacing the node~$W$ by two nodes~$U$ and~$V$, adding an arc $\gamma$ from $U$ to $V$, and 
    \item connecting an incoming arc~$\alpha$ of~$W$ to~$U$ if and only if its source set~$\so[\alpha]$ is contained in a connected component of $G \ssm \down[W]$ adjacent to $\down[U]$, and an outgoing arc~$\beta$ of~$W$ to~$V$ if and only if its target set~$\ta[\beta]$ is contained in a connected component of $G \ssm \up[W]$ adjacent to $\up[V]$.
  \end{enumerate}
\end{definition}

\begin{proposition}
  \label{prop:vertexsplitting} 
  The splitting of any splittable partition in any spine on~$G$ is a spine on~$G$.
\end{proposition}

%\begin{remark}
%  The following proof is "formal", i.e. it doesn't use the fact that $G$ is a block graph. 
%\end{remark}

\begin{proof}
  Let~$\spine'$ be a directed tree obtained by splitting a splittable partition~$U \sqcup V = W$ of a node~$W$ in a spine $\spine$ on~$G$.
  We clearly just need to prove the local condition of \cref{def:spine} around the nodes~$U$ and~$V$ of~$\spine'$.
  We give the argument for~$U$; the argument for~$V$ is symmetric.
  
  We start with the incoming arcs of~$U$.
  First, each incoming arc~$\alpha$ of~$U$ is an incoming arc of~$W$, hence~$\so[\alpha]$ is contained in a connected component of~$G \ssm \down[W]$, hence in a connected component of~$G \ssm \down[U]$.
  Moreover, any two distinct incoming arcs~$\alpha$ and~$\alpha'$ of~$U$ are distinct incoming arcs of~$W$. Thus~$\so[\alpha]$ and~$\so[\alpha']$ are contained in distinct connected components of~$G \ssm \down[W]$, hence in distinct connected components of~$G \ssm \down[U]$, since~$U$ is contained in a connected component of~$G \ssm \down[V]$.

  We now consider the outgoing arcs of~$U$.
  To prove that the target set of each outgoing arc~$\beta$ of~$U$ is contained in a connected component of~$G \ssm \up[U]$, we distinguish two cases:
  \begin{itemize}
    \item If~$\beta \ne \gamma$, then~$\beta$ is an outgoing arc of~$W$, hence~$\ta[\beta]$ is contained in a connected component of~$G \ssm \up[W]$, hence in a connected component of~$G \ssm \up[U]$.
    \item If~$\beta = \gamma$, then~$\ta[\gamma]$ is the union of~$V$ with~$\so[\alpha']$ for all incoming arcs~$\alpha'$ of~$V$ and~$\ta[\beta']$ for all outgoing arcs~$\beta'$ of~$V$. We next prove that all these sets are contained in the same connected component of~$G \ssm \up[U]$.
    \begin{itemize}
      \item By \cref{def:vertexsplitting}, $V$ is contained in a connected component~$C$ of~$G \ssm \up[U]$. 
      \item Consider an incoming arc~$\alpha'$ of~$V$. The set~$\so[\alpha']$ is contained in a connected component~$D$ of~$G \ssm \down[W]$, and in a connected component~$E$ of~$G \ssm \down[V]$, with~$D \subseteq E$. By \cref{prop:vertexsplitting}, $D$ is not adjacent to~$\down[U]$. By \cref{def:vertexsplitting}, $E$ is thus disjoint from~$U$. This implies on the one hand that~$D$ is disjoint from~$\up[U]$, thus connected in~$G \ssm \up[U]$, and on the other hand that~$D$ is adjacent to~$\down[V]$, hence contained in~$C$. 
      \item Consider an outgoing arc~$\beta'$ of~$V$. By \cref{prop:vertexsplitting}, the set $\ta[\beta']$ is contained in a connected component of~$G \ssm \up[W]$ adjacent to~$V$, hence $\ta[\beta']$ is contained in~$C$.
    \end{itemize}
  \end{itemize}
  To prove that the target sets of two distinct outgoing arcs~$\beta$ and~$\beta'$ of~$U$ are contained in two distinct connected components of~$G \ssm \up[U]$, we distinguish two cases:
  \begin{itemize}
  \item Assume that~$\beta$ and~$\beta'$ are both distinct from~$\gamma$. Let~$C$ be the connected component of~$G \ssm \up[U]$ containing~$V$, and let~$D$ and~$D'$ (resp.~$E$ and~$E'$) the connected components of $G \ssm \up[W]$ (resp.~$G \ssm \up[U]$) containing~$\ta[\beta]$ and $\ta[\beta']$. By \cref{prop:vertexsplitting}, $D$ and~$D'$ are not adjacent to~$\up[V]$. By \cref{def:vertexsplitting}, $E$ and~$E'$ are thus disjoint from~$V$. This implies that~$E = D$ and~$E' = D'$ are distinct.
  \item Assume that~$\beta' = \gamma$. As before, the connected component of~$G \ssm \up[U]$ containing~$\ta[\beta]$ is disjoint from~$V$, thus is distinct from that containing~$\ta[\gamma]$.
  \qedhere
  \end{itemize}
\end{proof}

\begin{proposition}
  \label{prop:contractionSplitting}
  Arc contraction and node splitting are inverse operations.
\end{proposition}

\begin{proof}
  It is clear that if~$\spine'$ is the splitting of~$U \sqcup V$ in~$\spine$, then~$\spine$ is the contraction of the arc joining~$U$ to~$V$ in~$\spine'$.
  Conversely, if~$\spine$ is the contraction of an arc joining~$U$ to~$V$ in~$\spine'$, then the partition~$U \sqcup V$ is splittable by \cref{def:spine}, and~$\spine'$ is the splitting of~$U \sqcup V$~in~$\spine$.
\end{proof}

\begin{definition}
  The \defn{spine poset} of~$G$ is the poset on spines on~$G$ defined by~$\spine \le \spine'$ if and only if~$\spine$ is obtained from~$\spine'$ by arc contractions, or equivalently~$\spine'$ is obtained from~$\spine$ by node~splittings.
\end{definition}

\begin{corollary} 
 The spine poset is graded by the number of nodes.
 Note that:
 \begin{itemize}
   \item its unique rank $0$ (\ie minimal) element is the spine with a single node, 
   \item its rank~$1$ elements are the spines with precisely two nodes, 
   \item its corank~$1$ elements are the spines where the nodes are all singletons except one pair,
   \item its corank~$0$ (\ie maximal) elements are the spines where the nodes are all singletons.
 \end{itemize}
\end{corollary}

\begin{remark}
  In the spine poset:
  \begin{itemize}
    \item a spine with~$a$ arcs covers~$a$ spines, and is larger than precisely $\binom{a}{b}$ spines with~$b$ arcs,
    \item a spine with~$k$ nodes of cardinality~$n_1, \dots, n_k$ is covered by at least~$2^{|\set{i \in [k]}{n_i \ge 2}|}$ and at most~$\prod_{i \in [k]} 2^{n_i}-2$ spines. In particular, a corank~$1$ spine is covered by precisely $2$ maximal~spines.
  \end{itemize}
\end{remark}

\begin{remark}
  All the results in this section hold if and only if $G$ is a block graph. 
  \vincent{Not the right place...}
\end{remark}
  
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Spine complex}

We call \defn{splittable partitions} of~$G$ the splittable partitions of the vertex set of~$G$ (see \cref{def:splittable}).

\begin{lemma}
  \label{lem:spineComplex}
  Let $G$ be a decorated block graph, let $\spine$ be a spine on $G$, and let~$\gamma$ be an arc of~$\spine$.
  Then the source set~$\so[\gamma]$ and the target set~$\ta[\gamma]$ form a splittable partition of~$G$.
\end{lemma}

\begin{proof}
  Immediate from \cref{def:spine}.
\end{proof}

\begin{definition}
  We call \defn{arc partitions} of~$\spine$ the splittable partitions~$\so[\gamma] \sqcup \ta[\gamma]$ of~$G$ for all arcs~$\gamma$ of~$\spine$.
\end{definition}

Note that contracting an arc in~$\spine$ precisely removes one arc partition of~$\spine$.
This yields the following simplicial complex on splittable partitions of~$G$.

\begin{definition}
  \label{def:spineComplex}
  The \defn{spine complex} of~$G$ is the simplicial complex whose vertices are the splittable partitions of~$G$ and whose simplices are the sets of arc partitions of the spines on~$G$.
\end{definition}

We will prove later that this complex is flag.
\vincent{todo}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Blossoming spines}

In the next section, we aim at describing a natural surjection from the ordered partitions (resp.~the permutations) of the vertex set of~$G$ to the spines (resp.~the maximal spines) on~$G$.
For this, it is convenient to add further information to a spine on~$G$.
Here, we need to manipulate both the vertices and the cliques of~$G$, thus we consider a maple tree~$M$ corresponding to the block graph~$G$.

\begin{definition}
  \label{def:blossomingTree}
  A \defn{directed blossoming tree} is a directed tree~$\spine$ with additional \defn{blossoms} (either incoming or outgoing) which are half-arcs.
  A \defn{cut} of a directed blossoming tree~$\spine$ is a subset~$\Gamma$ of arcs and blossoms of~$\spine$ such that any directed path joining an incoming blossom of~$\spine$ to an outgoing blossom of~$\spine$ contains precisely one element of~$C$.
  A cut~$\Gamma$ of~$\spine$ partitions the vertex set of~$\spine$ into its \defn{source set}~$\so[\Gamma]$ and its \defn{target set}~$\ta[\Gamma]$.
  For instance, the set of incoming (resp.~outgoing) blossoms is a cut whose source (resp.~target) set is empty and whose target (resp.~source) set is the set of vertices of~$\spine$.
  A \defn{sweep sequence} of~$\spine$ is a sequence~$\Gamma_0, \dots, \Gamma_p$ of cuts of~$\spine$ such that $\Gamma_0$ is the cut formed by all incoming blossoms of~$\spine$ while $\Gamma_p$ is the cut formed by all outgoing blossoms of~$\spine$, and for all~$i \in [p]$, there is a node~$U_i$ of~$\spine$ such that~$\Gamma_{i-1} \ssm \{U_i\} = \Gamma_i \ssm \{U_i\}$.
\end{definition}

\begin{definition}
  \label{def:blossomingSpine}
  Let~$M$ be a maple tree with red vertex set~$R$ and blue vertex set~$B$, and~$G$ be the block graph obtained by tapping~$M$.
  The \defn{blossoming} of a spine~$\spine$ on~$G$ is the directed blossoming tree obtained from~$\spine$ by
  \begin{enumerate}[(i)]
    \item labeling each arc~$\gamma$ of~$\spine$ by the vertices of~$R$ which belong to both the connected component of~$\smash{M \ssm \up[{\so[\gamma]}]}$ containing~$\ta[\gamma]$ and the connected component of~$\smash{M \ssm \down[{\ta[\gamma]}]}$ containing~$\so[\gamma]$,
    \item adding at each node~$U$ of~$\spine$ an incoming (resp.~outgoing) blossom labeled by the the red vertices of~$C$ for each connected component~$C$ of~$M \ssm \down[{\ta[U]}]$ (resp.~of~$M \ssm \up[{\so[U]}]$) adjacent to~$U$ such that there is no incoming arc~$\alpha$ (resp.~outgoing arc~$\beta$) of~$U$ with~$\so[\alpha]$ (resp.~$\ta[\beta]$) contained in~$C$.
  \end{enumerate}
  We call \defn{blossoming spines} of~$M$ the blossomings of the spines of~$G$.
\end{definition}

\begin{lemma}
  \label{lem:connectedComponents}
  Let~$M$ be a maple tree with red vertices~$R$ and blue vertices~$B$, and let~$\spine$ be a blossoming spine on~$M$.
  Then the labels of the incoming (resp.~outgoing) blossoms of~$S$ are precisely the intersections of~$R$ with connected component of~${M \ssm \down[B]}$ (resp.~of~${M \ssm \up[B]}$).
\end{lemma}

\begin{proposition}
  \label{prop:blossomingSpine}
  Let~$M$ be a maple tree and let~$\spine$ be a blossoming spine on~$M$.
  For any cut~$\Gamma$ of~$\spine$, the labels of the arcs and blossoms of~$\Gamma$ are precisely the intersections of the red vertices of~$M$ with the connected components  of~$\smash{M \ssm \big( \up[{\so[\Gamma]}] \cup \down[{\ta[\Gamma]}] \big)}$.
\end{proposition}

\begin{proof}
  Consider a sequence~$\Gamma_0, \dots \Gamma_p$ of cuts of~$\spine$ which sweeps the spine~$\spine$ from its incoming blossoms to its outgoing blossoms, and passes at each step a single node of~$\spine$.
  In other words, $\Gamma_0$ is the cut formed by all incoming blossoms, and for all~$i \in [p]$, there is a node~$U_i$ of~$\spine$ such that~$\Gamma_{i-1} \ssm \so[U_i] = \Gamma_i \ssm \ta[U_i]$.
  We prove that the result holds for all cuts~$\Gamma_i$ by induction on~$i$.
  The result then follows since any cut of~$\spine$ can be reached in a sequence of cuts sweeping~$\spine$ from its incoming blossoms to its outgoing blossoms.
  \vincent{todo}
  \vincent{Do we really need a proof by induction?}
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Surjection maps}

Recall that an \defn{ordered partition} of a set~$B$ is a (ordered) sequence~$\pi \eqdef \pi_1 | \dots | \pi_p$ of non-empty (unordered) subsets of~$B$ which form a partition of~$B$.

\begin{definition}
  \label{def:sweepingAlgorithm}
  Let~$M$ be a maple tree with red vertices~$R$ and blue vertices~$B$.
  The \defn{sweeping algorithm} is a procedure that maps an ordered partition~$\pi \eqdef \pi_1 | \dots | \pi_p$ of~$B$ into a blossoming spine~$\spine(\pi)$ on~$M$.
  It follows a sweep sequence~$\Gamma_0, \dots \Gamma_p$ of~$\spine(\pi)$ and constructs~$\spine(\pi)$ by maintaining before step~$i$ the blossoming forest induced by the nodes of~$\spine(\pi)$ contained in~$\pi_1 \cup \dots \cup \pi_{i-1}$.
  The iterative procedure is as follows:
  \begin{itemize}
    \item start with the cut~$\Gamma_0$ formed by an incoming blossom for each connected component of~$M \ssm \down[B]$,
    \item at step~$i$:
      \begin{itemize}
        \item create a node~$U$ for each non-empty intersection of~$\pi_i$ with a connected component of~$M \ssm (\up[\pi_1] \cup \dots \cup \up[\pi_{i-1}] \cup \down[\pi_{i+1}] \cup \dots \cup \down[\pi_p])$,
        \item attach as incoming arcs of~$U$ the outgoing blossoms of~$\Gamma_{i-1}$ adjacent to~$U$,
        \item create at~$U$ one outgoing blossom labeled by~$R \cap C$ for each connected component~$C$ of~$M \ssm $ 
        \item define the new cut~$\Gamma_i$...
      \end{itemize}
    \item end with the cut~$\Gamma_p$ an outgoing blossom for each connected component of~$M \ssm \up[B]$.
  \end{itemize}
  \vincent{improve that}
\end{definition}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Flips and flip poset}

\begin{definition}
Let $G$ be a decorated block graph and let $\spine$ be a maximal spine on~$G$.
Consider two vertices $U = \{u\}$ and $V = \{v\}$ of $\spine$ related by an arc $\gamma$. 
Let $\alpha$ be the incoming arc of $U$ such that~$\so[\alpha]$ and~$V$ are contained in the same connected component of $G \ssm \down[U]$, and let $\beta$ be the outgoing arc of $V$ such that~$\ta[\beta]$ and~$U$ are contained in the same connected component of $G \ssm \up[V]$.
We define $\spine'$ to be the spine obtained from $\spine$ by reversing the orientation of~$\gamma$, grafting the arc~$\alpha$ to~$V$ and the arc~$\beta$ to~$U$.
We say that $\spine'$ is obtained from $\spine$ by \defn{flipping} the arc~$\gamma$. 
\end{definition}

\begin{figure}[h!]
  TBC
  \caption{A spine flip.}
\end{figure}

The fact that $\spine'$ is indeed a spine is immediate from the definitions. Contracting $\gamma$ in either $\spine$ or $\spine'$, we obtain the same spine $\spine''$. 

\begin{lemma} 
  \label{lemma:coveringpair} 
  The spines~$\spine$ and $\spine'$ are the only spines covering $\spine''$ in the spine poset.
\end{lemma}

\begin{proof}
  This follows from \cref{prop:vertexsplitting}.
\end{proof}
  
\begin{corollary} 
   The spine poset $\spines$ is a closed pseudo-manifold. 
\end{corollary}

\begin{proof}
  TBC
\end{proof}
  
\begin{definition}[Flip poset] 
  For $\spine$ and $\spine'$ two maximal spines, we say that $\spine \preccurlyeq \spine'$ if and only if $\spine'$ is obtained from $\spine$ by a flip. 
\end{definition}

\begin{remark}
  The question of whether or not the flip poset $(\maxspines,\preccurlyeq)$ is a lattice is a difficult question. It depends on the decoration of $G$. We know that if $G$ is a tree, it is always the case \cite{PonsPilaud18}, for $G$ a block graph it is generally not true. See \cite{BarnardMcConville18}. \guillaume{Nos calculs?; donner un exemple, un contre-exemple}
\end{remark}
  
\begin{definition}[Flip graph] 
  The \defn{flip graph} is the Hasse diagram of the flip poset. 
\end{definition}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Geometry: block graph permutreehedra}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Algebra: operad structure}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\appendix

\section{More combinatorics}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Nestings, tubings and Forcey-Ronco substitution on graph-associahedra}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Generalized tubings}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Geometric properties of block graph permutreehedra}







\section*{Acknowledgments}

CRM in Barcelona 

\bibliographystyle{alpha}
\bibliography{blockgraph}
\label{sec:biblio}

\end{document}